CREATE TABLE PERFIL_USUARIO
(
    ID_USUARIO NUMBER GENERATED BY DEFAULT AS IDENTITY,
    NOME       VARCHAR2(100) NOT NULL,
    EMAIL      VARCHAR2(150) NOT NULL,
    SENHA      VARCHAR2(100) NOT NULL,
    CONSTRAINT PK_PERFIL_USUARIO PRIMARY KEY (ID_USUARIO),
    CONSTRAINT UQ_PERFIL_EMAIL UNIQUE (EMAIL)
);


CREATE TABLE MUSICAS
(
    ID_MUSICA NUMBER GENERATED BY DEFAULT AS IDENTITY,
    NOME      VARCHAR2(150) NOT NULL,
    DESCRICAO VARCHAR2(400),
    CATEGORIA VARCHAR2(50),
    URL       VARCHAR2(500), -- URLs podem ser longas
    CONSTRAINT PK_MUSICAS PRIMARY KEY (ID_MUSICA)
);


CREATE TABLE HISTORICO_MUSICAS
(
    ID_HISTORICO  NUMBER GENERATED BY DEFAULT AS IDENTITY,
    ID_USUARIO    NUMBER NOT NULL,
    ID_MUSICA     NUMBER NOT NULL,
    DATA_ESCUTADA TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    CONSTRAINT PK_HISTORICO PRIMARY KEY (ID_HISTORICO),
    CONSTRAINT FK_HISTORICO_USUARIO FOREIGN KEY (ID_USUARIO)
        REFERENCES PERFIL_USUARIO (ID_USUARIO) ON DELETE CASCADE,
    CONSTRAINT FK_HISTORICO_MUSICA FOREIGN KEY (ID_MUSICA)
        REFERENCES MUSICAS (ID_MUSICA) ON DELETE CASCADE
);